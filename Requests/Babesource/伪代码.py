
# 第一部分：搜索{人名tag}标签，获取相册列表
主页：https://babesource.com/

搜索请求url："https://babesource.com/pornstars/{人名tag}/page{页码}.html"
示例请求url："https://babesource.com/pornstars/nancy-12284/page1.html"，如果没有图片元素，这表示没有更多页码。

Network/Doc文档response响应示例：
```html

<div class="main-content__card tumba-card">
        <a class="main-content__card-link" href="https://babesource.com/galleries/nancy-heal-fit-190563.html">
            <picture>
                <img alt="Nancy" loading="lazy" class="lazy" srcset="https://media.babesource.com/galleries/6874bf670b770/thumbs/19856.jpg" src="https://babesource.com/templates/babesource_new/images/bg-item.png" data-src="https://media.babesource.com/galleries/6874bf670b770/thumbs/19856.jpg" src="https://babesource.com/templates/babesource_new/images/bg-item.png">
            </picture>
        </a>
        <div class="main-content__counts">
            <span class="main-content__count-views">
                <svg fill="none" height="10" viewBox="0 0 12 10" width="12"
                     xmlns="http://www.w3.org/2000/svg">
                    <path d="M6 0C3.31819 0 0.915086 1.95516 0.0200536 4.86532C-0.00668455 4.9528 -0.00668455 5.0472 0.0200536 5.13468C0.915086 8.04484 3.31819 10 6 10C8.68181 10 11.0849 8.04484 11.9799 5.13468C12.0067 5.0472 12.0067 4.9528 11.9799 4.86532C11.0849 1.95516 8.68179 0 6 0ZM6 9.16666C3.6804 9.16666 1.59552 7.49797 0.77262 5C1.59552 2.50203 3.68038 0.833341 6 0.833341C8.3196 0.833341 10.4045 2.50203 11.2274 5C10.4045 7.49797 8.3196 9.16666 6 9.16666Z"
                          fill="white" />
                    <path d="M6.00004 2.5C4.7593 2.5 3.75 3.62143 3.75 5C3.75 6.37858 4.7593 7.50001 6.00004 7.50001C7.24077 7.50001 8.25008 6.3786 8.25008 5C8.25008 3.62141 7.24077 2.5 6.00004 2.5ZM6.00004 6.66666C5.17274 6.66666 4.50002 5.91918 4.50002 5C4.50002 4.0808 5.17277 3.33334 6.00004 3.33334C6.82733 3.33334 7.50006 4.08083 7.50006 5C7.50006 5.91918 6.82731 6.66666 6.00004 6.66666Z"
                          fill="white" />
                </svg>

                17524</span>
            <span class="main-content__count-like">
                <svg fill="none" height="13" viewBox="0 0 10 10" width="13"
                     xmlns="http://www.w3.org/2000/svg">
                    <path d="M9.47902 3.62621C9.21377 3.39081 8.87856 3.26104 8.53753 3.26104H8.21981H7.0772H6.53504V1.79736C6.53504 1.09721 6.33392 0.587186 5.93459 0.282379C5.30499 -0.194449 4.45094 0.0741441 4.41305 0.0862156C4.26731 0.134502 4.1682 0.273325 4.1682 0.430256V2.19572C4.1682 2.73291 3.92044 3.18861 3.42784 3.55378C3.05474 3.83142 2.6729 3.95818 2.62334 3.97326L2.58837 3.98232C2.4572 3.82841 2.26482 3.73183 2.04912 3.73183H0.719962C0.323546 3.73183 0 4.06682 0 4.47725V8.99202C0 9.40246 0.323546 9.73744 0.719962 9.73744H2.05495C2.22984 9.73744 2.39307 9.67105 2.5155 9.5624C2.78366 9.83402 3.14801 10 3.54152 10H4.86776H5.00476H7.71846C8.1382 10 8.50838 9.89437 8.79112 9.69821C9.15256 9.44471 9.377 9.04333 9.44113 8.53029L9.98037 5.05971C10.0649 4.52252 9.87252 3.97326 9.47902 3.62621ZM2.07536 8.99202C2.07536 9.0041 2.06661 9.01315 2.05495 9.01315H0.719962C0.708303 9.01315 0.699558 9.0041 0.699558 8.99202V4.47725C0.699558 4.46518 0.708303 4.45613 0.719962 4.45613H2.05495C2.06661 4.45613 2.07536 4.46518 2.07536 4.47725V8.99202ZM9.28955 4.94804L8.75031 8.42466C8.75031 8.42768 8.75031 8.43371 8.7474 8.43975C8.72408 8.64798 8.64829 9.27872 7.71846 9.27872H5.00476H4.86776H3.54152C3.16842 9.27872 2.84196 8.98901 2.78366 8.60573C2.78075 8.59064 2.77783 8.57555 2.77492 8.56348V4.68247L2.79532 4.67643C2.80115 4.67643 2.80406 4.67342 2.80989 4.67342C2.8303 4.66738 3.32582 4.52252 3.81842 4.15736C4.50341 3.65337 4.86776 2.97434 4.86776 2.19572V0.729027C5.06014 0.707902 5.32539 0.716956 5.52068 0.864833C5.73055 1.02478 5.83548 1.33864 5.83548 1.79434V3.62017C5.83548 3.81935 5.99289 3.98232 6.18526 3.98232H7.0772H8.21981H8.53753C8.71242 3.98232 8.88439 4.05173 9.0243 4.17244C9.23417 4.35955 9.33328 4.65531 9.28955 4.94804Z"
                          fill="white" />
                </svg>
                93%
            </span>

        </div>

        <h5 class="main-content__title">Nancy</h5>
    </div>

```
逐个获取每个相册标签下的'a'元素下的'href'属性的值，即为图片详情页请求url。
示例：href="https://babesource.com/galleries/nancy-heal-fit-190563.html"，完整请求url为：https://babesource.com/galleries/nancy-heal-fit-190563.html

获取'a'元素下'href'属性值最后一个'/'后的文本内容，即为相册的标题，这个值为相册的名称。需要写入到csv文件的'相册'字段。，如：'nancy-heal-fit-190563'



# 第二部分：访问图片详情页，获取图片信息并写入表格
详情页请求url的响应示例：
```html
                    <div class="box-massage__tumba tumba">
                        <div class="box-massage__card tumba-card">
                            <button class="box-massage__slideshow" id="startSlideshowAnchor">
                                <span>
                                    <svg fill="none" height="30" viewBox="0 0 30 30" width="30" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M22.3334 7.19995H7.66664C7.11434 7.19995 6.66663 7.64761 6.66663 8.19997V25.8C6.66663 26.3523 7.11428 26.8 7.66664 26.8H22.3333C22.8856 26.8 23.3333 26.3523 23.3333 25.8V8.19997C23.3333 7.64761 22.8857 7.19995 22.3334 7.19995ZM21.3333 24.8H8.66666V9.19993H21.3333V24.8Z" fill="white"/>
                                        <path d="M4.33352 8.8667C3.78115 8.8667 3.3335 9.46033 3.3335 10.1928V23.8073C3.3335 24.5398 3.78115 25.1334 4.33352 25.1334C4.88582 25.1334 5.33354 24.5398 5.33354 23.8073V10.1928C5.33348 9.46041 4.88582 8.8667 4.33352 8.8667Z" fill="white"/>
                                        <path d="M1.00002 10.5333C0.447656 10.5333 0 11.1814 0 11.9811V22.0189C0 22.8185 0.447656 23.4667 1.00002 23.4667C1.55238 23.4667 2.00004 22.8186 2.00004 22.0189V11.9811C1.99998 11.1814 1.55232 10.5333 1.00002 10.5333Z" fill="white"/>
                                        <path d="M25.6665 8.8667C25.1142 8.8667 24.6665 9.46033 24.6665 10.1928V23.8073C24.6665 24.5398 25.1142 25.1334 25.6665 25.1334C26.2189 25.1334 26.6665 24.5398 26.6665 23.8073V10.1928C26.6665 9.46041 26.2189 8.8667 25.6665 8.8667Z" fill="white"/>
                                        <path d="M29 10.5333C28.4477 10.5333 28 11.1814 28 11.9811V22.0189C28 22.8185 28.4476 23.4667 29 23.4667C29.5523 23.4667 30 22.8185 30 22.0188V11.9811C30 11.1814 29.5523 10.5333 29 10.5333Z" fill="white"/>
                                    </svg>
                                </span>
                                <p>Slideshow</p>
                            </button>
                            <a class="box-massage__card-link" href="https://media.babesource.com/galleries/6874bf670b770/19856.jpg">
                                <picture>
                                    <img alt="" loading="lazy" class="lazy" data-src="https://media.babesource.com/galleries/6874bf670b770/thumbs/19856.jpg" src="https://babesource.com/templates/babesource_new/images/bg-item.png">
                                </picture>
                            </a>
                            <div class="box-massage__icon-search">
                                <i class="fa-solid fa-magnifying-glass"></i>
                            </div>
                        </div>
                    </div>

```
详情页提取图集信息并写入表格
提取url：'a'元素下的'href'属性，即图片原图url，如：'https://media.babesource.com/galleries/6874bf670b770/19856.jpg'
提取标题：'img'元素下的'alt'属性，如：alt=''，标题为空字符串。

图片名称：从图片url中提取最后一个'/'后的文本内容，如：'19856.jpg'，去掉扩展名即为名称'19856'。


写入CSV文件：字段：图片URL、标题、名称、相册/所属集合
注意事项：相册字段需要从第一部分搜索{人名tag}标签，获取相册列表。

# 第三部分：启动下载图片
启动下载图片到本地文件夹
解耦式异步多线程下载图片到本地文件夹,使用相册字段作为子文件夹名，文件命名为名称字段，保留原始图片格式扩展名。
{人名tag}标签文档本地路径：“R:\py\Auto_Image-Spider\Requests\Babesource\人名tag.txt”
"人名tag.txt"内容示例：
```txt
anna-l-vWIOQsU8
danny-vWIOQsU8
```

csv文件路径存储路径：“R:\py\Auto_Image-Spider\Requests\Babesource\all_images_data.csv”
下载图片存储路径“R:\py\Auto_Image-Spider\Requests\Babesource\images\”
示例：R:\py\Auto_Image-Spider\Requests\Babesource\images\anna-l-and-danny-sexual-attraction-0013.jpg


Redis 去重逻辑示例
REDIS_HOST = 'localhost'
REDIS_PORT = 6379
REDIS_KEY = 'babesource_image_url_set' # 使用 URL 作为唯一标识符

    def __init__(self, csv_dir_path, csv_filename, redis_host=REDIS_HOST, redis_port=REDIS_PORT):
        """
        初始化爬虫实例，集成 Redis/内存去重逻辑。
        """
        self.csv_dir_path = csv_dir_path
        self.csv_path = os.path.join(self.csv_dir_path, csv_filename) 
        self.csv_lock = Lock() # 用于 CSV 写入的线程锁
        self.headers = {
            'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36'
        }
        urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

        # --- 去重初始化逻辑 ---
        try:
            # 尝试连接 Redis
            self.redis = redis.StrictRedis(host=redis_host, port=redis_port, decode_responses=True)
            # 尝试执行一次 ping 来验证连接
            self.redis.ping()
            print("✅ Redis 连接成功，使用 Redis 集合进行去重。")
        except redis.exceptions.ConnectionError as e:
            print(f"⚠️ Redis 连接失败 ({e})，将使用内存去重。")
            self.redis = None
            # 内存去重集合，注意：内存集合在多线程间共享，但只在当前程序生命周期内有效。
            # 由于线程池是在当前进程内运行，因此这个 set 是共享的。
            self.visited_urls = set()
        except Exception as e:
            print(f"⚠️ Redis 初始化遇到其他错误 ({e})，将使用内存去重。")
            self.redis = None
            self.visited_urls = set()
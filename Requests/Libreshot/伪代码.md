帮我设计高效的爬虫代码，下面的伪代码中已经给出相关信息和必要的条件：


请求网址："https://libreshot.com/?s={tag}",请求方法：GET
示例网址："https://libreshot.com/?s=girl"
Doc文档response响应示例：
```html

                <div class=posts id=posts>
                    <div class=grid-sizer></div>
                    <div class=post-container>
                        <div id=post-12569 class="post-12569 post type-post status-publish format-standard has-post-thumbnail hentry category-people tag-alone tag-beach tag-children tag-family tag-girls tag-holiday tag-people tag-sad tag-sand tag-summer tag-travel tag-young-people">
                            <span id=image-description>
                                <a class=featured-media title="Small sad girl on the beach - Free Image For Commercial Use" href=https://libreshot.com/small-sad-girl-on-the-beach/>
                                    <img width=508 height=339 src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20508%20339'%3E%3C/svg%3E" data-src=https://libreshot.com/wp-content/uploads/2018/11/sad-girl-508x339.jpg class="attachment-post-thumb size-post-thumb wp-post-image lazy" alt="Small sad girl on the beach" decoding=async fetchpriority=high data-srcset="https://libreshot.com/wp-content/uploads/2018/11/sad-girl-508x339.jpg 508w, https://libreshot.com/wp-content/uploads/2018/11/sad-girl-1536x1024.jpg 1536w, https://libreshot.com/wp-content/uploads/2018/11/sad-girl-2048x1365.jpg 2048w, https://libreshot.com/wp-content/uploads/2018/11/sad-girl-973x649.jpg 973w, https://libreshot.com/wp-content/uploads/2018/11/sad-girl-462x308.jpg 462w, https://libreshot.com/wp-content/uploads/2018/11/sad-girl-768x512.jpg 768w, https://libreshot.com/wp-content/uploads/2018/11/sad-girl-861x574.jpg 861w" data-sizes="(max-width: 508px) 100vw, 508px">
                                </a>
                                <span id=show-on-hover>
                                    <h2 class="post-title" style="font-size:15px;padding-left: 10px;">
                                        <a href=https://libreshot.com/small-sad-girl-on-the-beach/ title="Small sad girl on the beach">Small sad girl on the beach - Free image</a>
                                    </h2>
                                    <span class=post-excerpt>
                                        <time datetime=2018-11-19T10:05:54+01:00 itemprop=datePublished>November 19, 2018</time>
                                        <br>
                                        <div style="font-size:14px;font-weight: lighter;padding: 5px 10px;">
                                            <a href=https://libreshot.com/free-images/alone/ rel=tag itemprop=keywords>alone</a>
                                            , <a href=https://libreshot.com/free-images/beach/ rel=tag itemprop=keywords>Beach</a>
                                            , <a href=https://libreshot.com/free-images/children/ rel=tag itemprop=keywords>Children</a>
                                            , <a href=https://libreshot.com/free-images/family/ rel=tag itemprop=keywords>Family</a>
                                            , <a href=https://libreshot.com/free-images/girls/ rel=tag itemprop=keywords>Girls</a>
                                            , <a href=https://libreshot.com/free-images/holiday/ rel=tag itemprop=keywords>Holiday</a>
                                            , <a href=https://libreshot.com/free-images/people/ rel=tag itemprop=keywords>People</a>
                                            , <a href=https://libreshot.com/free-images/sad/ rel=tag itemprop=keywords>Sad</a>
                                            , <a href=https://libreshot.com/free-images/sand/ rel=tag itemprop=keywords>Sand</a>
                                            , <a href=https://libreshot.com/free-images/summer/ rel=tag itemprop=keywords>Summer</a>
                                            , <a href=https://libreshot.com/free-images/travel/ rel=tag itemprop=keywords>Travel</a>
                                            , <a href=https://libreshot.com/free-images/young-people/ rel=tag itemprop=keywords>Young People</a>
                                        </div>
                                    </span>
                                </span>
                            </span>
                        </div>
                    </div>


```
提取字段：
- 图片URL (URL)，即'img'的'data-src'值，并去除url中的分辨率参数'-508x339'即为原图
- 'a'的'title'值,如：`<a href=https://libreshot.com/small-sad-girl-on-the-beach/ title="Small sad girl on the beach">`

- 图片名称 (ImageName) —— 从图片URL中提取"


{tag}文本本地文件路径：D:\myproject\Code\爬虫\爬虫数据\libreshot\ram_tag_list_备份.txt

将获取后的所有数据分列实时保存到CSV文件
    def write_to_csv(self, title, name, url, csv_path, tag):
        """
        写入 CSV 方法，已集成线程锁，确保多线程安全。
        """
        try:
            with self.csv_lock: # 使用线程锁
                os.makedirs(os.path.dirname(csv_path), exist_ok=True)
                is_file_empty = not os.path.exists(csv_path) or os.stat(csv_path).st_size == 0
                
                with open(csv_path, 'a', newline='', encoding='utf-8-sig') as f:
                    writer = csv.writer(f)
                    
                    if is_file_empty:
                        writer.writerow(['Title', 'ImageName', 'URL', 'TAG'])
                        
                    writer.writerow([title, name, url, tag])
        except Exception as e:
            print(f"[{tag}] [✗] 写入 CSV 出错: {e}")


多线程爬取{tag}中的图片数据，线程数可配置为，10个标签处理线程。


Redis 去重逻辑示例
REDIS_HOST = 'localhost'
REDIS_PORT = 6379
REDIS_KEY = 'libreshot_image_url_set' # 使用 URL 作为唯一标识符



    def __init__(self, csv_dir_path, csv_filename, redis_host=REDIS_HOST, redis_port=REDIS_PORT):
        """
        初始化爬虫实例，集成 Redis/内存去重逻辑。
        """
        self.csv_dir_path = csv_dir_path
        self.csv_path = os.path.join(self.csv_dir_path, csv_filename) 
        self.csv_lock = Lock() # 用于 CSV 写入的线程锁
        self.headers = {
            'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36'
        }
        urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

        # --- 去重初始化逻辑 ---
        try:
            # 尝试连接 Redis
            self.redis = redis.StrictRedis(host=redis_host, port=redis_port, decode_responses=True)
            # 尝试执行一次 ping 来验证连接
            self.redis.ping()
            print("✅ Redis 连接成功，使用 Redis 集合进行去重。")
        except redis.exceptions.ConnectionError as e:
            print(f"⚠️ Redis 连接失败 ({e})，将使用内存去重。")
            self.redis = None
            # 内存去重集合，注意：内存集合在多线程间共享，但只在当前程序生命周期内有效。
            # 由于线程池是在当前进程内运行，因此这个 set 是共享的。
            self.visited_urls = set()
        except Exception as e:
            print(f"⚠️ Redis 初始化遇到其他错误 ({e})，将使用内存去重。")
            self.redis = None
            self.visited_urls = set()
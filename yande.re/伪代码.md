帮我设计高效的爬虫代码，下面的伪代码中已经给出相关信息和必要的条件：

请求网址："https://yande.re/post/{tag}",请求方法：GET
示例网址："https://yande.re/post/popular_recent"
Doc文档响应示例：
```html

                        <li style="width: 160px;" id="p1246002" class=" javascript-hide creator-id-482803">
                            <div class="inner" style="width: 150px; height: 150px;">
                                <a class="thumb" href="/post/show/1246002">
                                    <img src="https://assets.yande.re/data/preview/5a/25/5a25c9fa27f8c07421aecd942d5bfcec.jpg" style="margin-left: 0px;" alt="Rating: Questionable Score: 29 Tags: animal_ears bay breasts bunny_ears bunny_girl goddess_of_victory:_nikke maebari no_bra nopan pantyhose pasties rouge_(nikke) see_through tattoo teddy thighhighs User: KenB" class="preview" title="Rating: Questionable Score: 29 Tags: animal_ears bay breasts bunny_ears bunny_girl goddess_of_victory:_nikke maebari no_bra nopan pantyhose pasties rouge_(nikke) see_through tattoo teddy thighhighs User: KenB" width="150" height="116">
                                    <span class="plid">#pl https://yande.re/post/show/1246002</span>
                                </a>
                            </div>
                            <a class="directlink largeimg" href="https://files.yande.re/image/5a25c9fa27f8c07421aecd942d5bfcec/yande.re%201246002%20animal_ears%20bay%20breasts%20bunny_ears%20bunny_girl%20maebari%20no_bra%20nopan%20pantyhose%20pasties%20rouge_%28nikke%29%20see_through%20tattoo%20teddy%20thighhighs.jpg">
                                <span class="directlink-info">
                                    <img class="directlink-icon directlink-icon-large" src="https://assets.yande.re/assets/ddl_large-b6a70700b689a23392964bd25e0993d9229c3ffec4c7a4ef5dbe10a516c862d9.gif" alt="">
                                    <img class="directlink-icon directlink-icon-small" src="https://assets.yande.re/assets/ddl-ee9c03fa35a341df36dbc9d247ee4cd820e3534fa21e9f6127fc9dfcd980658e.gif" alt="">
                                    <img class="parent-display" src="https://assets.yande.re/assets/post-star-parent-d285dd41318c1fe1c500726fc01b57e9e600c88f1f2d039eee54015d0e85e499.gif" alt="">
                                    <img class="child-display" src="https://assets.yande.re/assets/post-star-child-e9a0fc526fbf75a32a2870e376fe953d9edd83d503a0a5d64f74b725ba2a874c.gif" alt="">
                                    <img class="flagged-display" src="https://assets.yande.re/assets/post-star-flagged-32d544649ddc8d22df6a0c695637c0aba9d25efefd40c753a9e95f63d883f2d5.gif" alt="">
                                    <img class="pending-display" src="https://assets.yande.re/assets/post-star-pending-3c474adbd4112537d620711311acde4af1d549cd795c8bdea14853205cba56ca.gif" alt="">
                                </span>
                                <span class="directlink-res">2512 x 1944</span>
                            </a>
                        </li>
```
提取字段：
- 评分 (Rating) 
- 分数 (Score)
- 标签 (Tags)
- 用户 (User)
- 图片名称 (ImageName) —— 从图片URL中提取，格式为："yande.re {PostID} {Tags}.jpg"
- 图片URL (URL)，即 `<a class="directlink largeimg" href="...">` 中的链接。

进一步获取高清原图（如有）：
- 将图片URL中的 `/jpeg/` 替换为 `/image/`，并将文件扩展名从 `.jpg` 改为 `.png`。使用替换后的URL进行请求，若响应状态码为200，则使用该高清原图URL，否则继续使用原始URL。# 示例：
# 低分辨率URL: https://files.yande.re/jpeg/5a25c9fa27f8c07421aecd942d5bfcec.jpg
# 高分辨率URL: https://files.yande.re/image/5a25c9fa27f8c07421aecd942d5bfcec.png
- 若高清原图不存在，则继续使用低分辨率URL进行下载。

{tag}文本本地文件路径：R:\py\Auto_Image-Spider\yande.re\ram_tag_周.txt

将获取后的所有数据（提取字段：评分、分数、标签、用户、图片名称、图片URL）分列实时保存到CSV文件，文件名为 all_records_yande_re_周.csv，

设置完全解耦式的数据保存机制（图片下载），保存在指定的本地目录 R:\py\Auto_Image-Spider\yande.re\output_v4 中。

多线程爬取{tag}中的图片数据，线程数可配置为10个下载线程，3个标签处理线程。